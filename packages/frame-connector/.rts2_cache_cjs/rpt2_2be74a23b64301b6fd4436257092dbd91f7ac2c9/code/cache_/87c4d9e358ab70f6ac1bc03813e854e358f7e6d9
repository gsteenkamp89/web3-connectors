{"code":"import { AbstractConnector } from '@web3-react/abstract-connector';\r\nimport ethProvider from 'eth-provider';\r\nimport invariant from 'tiny-invariant';\r\nexport class UserRejectedRequestError extends Error {\r\n    constructor() {\r\n        super();\r\n        this.name = this.constructor.name;\r\n        this.message = 'The user rejected the request.';\r\n    }\r\n}\r\nexport class FrameConnector extends AbstractConnector {\r\n    constructor(kwargs) {\r\n        invariant(kwargs.supportedChainIds.length === 1, 'This connector only supports 1 chainId at the moment.');\r\n        super(kwargs);\r\n        this.handleNetworkChanged = this.handleNetworkChanged.bind(this);\r\n        this.handleChainChanged = this.handleChainChanged.bind(this);\r\n        this.handleAccountsChanged = this.handleAccountsChanged.bind(this);\r\n        this.handleClose = this.handleClose.bind(this);\r\n    }\r\n    handleNetworkChanged(networkId) {\r\n        if (__DEV__) {\r\n            console.log(\"Handling 'networkChanged' event with payload\", networkId);\r\n        }\r\n        this.emitUpdate({ provider: this.provider, chainId: networkId });\r\n    }\r\n    handleChainChanged(chainId) {\r\n        if (__DEV__) {\r\n            console.log(\"Handling 'chainChanged' event with payload\", chainId);\r\n        }\r\n        this.emitUpdate({ chainId });\r\n    }\r\n    handleAccountsChanged(accounts) {\r\n        if (__DEV__) {\r\n            console.log(\"Handling 'accountsChanged' event with payload\", accounts);\r\n        }\r\n        this.emitUpdate({ account: accounts.length === 0 ? null : accounts[0] });\r\n    }\r\n    handleClose(code, reason) {\r\n        if (__DEV__) {\r\n            console.log(\"Handling 'close' event with payload\", code, reason);\r\n        }\r\n        this.emitDeactivate();\r\n    }\r\n    async activate() {\r\n        if (!this.provider) {\r\n            this.provider = ethProvider('frame');\r\n        }\r\n        this.provider\r\n            .on('networkChanged', this.handleNetworkChanged)\r\n            .on('chainChanged', this.handleChainChanged)\r\n            .on('accountsChanged', this.handleAccountsChanged)\r\n            .on('close', this.handleClose);\r\n        const account = await this.provider\r\n            .enable()\r\n            .then((accounts) => accounts[0])\r\n            .catch((error) => {\r\n            if (error && error.code === 4001) {\r\n                throw new UserRejectedRequestError();\r\n            }\r\n            else {\r\n                throw error;\r\n            }\r\n        });\r\n        return { provider: this.provider, account };\r\n    }\r\n    async getProvider() {\r\n        return this.provider;\r\n    }\r\n    async getChainId() {\r\n        return this.provider.send('eth_chainId');\r\n    }\r\n    async getAccount() {\r\n        return this.provider.send('eth_accounts').then((accounts) => accounts[0]);\r\n    }\r\n    deactivate() {\r\n        this.provider\r\n            .removeListener('networkChanged', this.handleNetworkChanged)\r\n            .removeListener('chainChanged', this.handleChainChanged)\r\n            .removeListener('accountsChanged', this.handleAccountsChanged)\r\n            .removeListener('close', this.handleClose);\r\n    }\r\n}\r\n//# sourceMappingURL=index.js.map","references":[],"map":"{\"version\":3,\"file\":\"index.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../src/index.ts\"],\"names\":[],\"mappings\":\"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\"}","dts":{"name":"/Users/gerhardsteenkamp/Desktop/linumlabs/web3-react/packages/frame-connector/src/index.d.ts","writeByteOrderMark":false,"text":"import { AbstractConnectorArguments, ConnectorUpdate } from '@web3-react/types';\r\nimport { AbstractConnector } from '@web3-react/abstract-connector';\r\nexport declare class UserRejectedRequestError extends Error {\r\n    constructor();\r\n}\r\nexport declare class FrameConnector extends AbstractConnector {\r\n    private provider;\r\n    constructor(kwargs: Required<AbstractConnectorArguments>);\r\n    private handleNetworkChanged;\r\n    private handleChainChanged;\r\n    private handleAccountsChanged;\r\n    private handleClose;\r\n    activate(): Promise<ConnectorUpdate>;\r\n    getProvider(): Promise<any>;\r\n    getChainId(): Promise<number>;\r\n    getAccount(): Promise<null>;\r\n    deactivate(): void;\r\n}\r\n"}}
